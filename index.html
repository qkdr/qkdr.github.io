import { useState } from "react";
import { Authenticated } from "convex/react";
import { SignInForm } from "./SignInForm";
import { SignOutButton } from "./SignOutButton";
import { Toaster } from "./components/ui/toaster";
import { useToast } from "./hooks/use-toast";

const scripts = [
  {
    id: 1,
    name: "Speed Boost",
    code: 'local player = game.Players.LocalPlayer\nlocal character = player.Character\nlocal humanoid = character:WaitForChild("Humanoid")\nhumanoid.WalkSpeed = 50',
    description: "زيادة سرعة الشخصية",
  },
  {
    id: 2,
    name: "Jump Power",
    code: 'local player = game.Players.LocalPlayer\nlocal character = player.Character\nlocal humanoid = character:WaitForChild("Humanoid")\nhumanoid.JumpPower = 100',
    description: "زيادة قوة القفز",
  },
  {
    id: 3,
    name: "Infinite Health",
    code: 'local player = game.Players.LocalPlayer\nlocal character = player.Character\nlocal humanoid = character:WaitForChild("Humanoid")\nhumanoid.MaxHealth = math.huge\nhumanoid.Health = humanoid.MaxHealth',
    description: "صحة لا نهائية",
  }
];

export default function App() {
  const { toast } = useToast();
  const [selectedScript, setSelectedScript] = useState<number | null>(null);

  const copyToClipboard = async (code: string) => {
    await navigator.clipboard.writeText(code);
    toast({
      title: "تم النسخ!",
      description: "تم نسخ السكربت إلى الحافظة",
      duration: 2000,
    });
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500">
      <header className="sticky top-0 z-10 bg-white/10 backdrop-blur-md p-4 flex justify-between items-center border-b border-white/20">
        <h2 className="text-2xl font-bold text-white">Roblox Scripts</h2>
        <SignOutButton />
      </header>

      <main className="container mx-auto p-8">
        <div className="max-w-4xl mx-auto">
          <Authenticated>
            <div className="grid gap-8">
              {scripts.map((script) => (
                <div
                  key={script.id}
                  className={`bg-white/10 backdrop-blur-md rounded-lg p-6 transform transition-all duration-300 hover:scale-102 ${
                    selectedScript === script.id ? 'ring-2 ring-yellow-400' : ''
                  }`}
                  onClick={() => setSelectedScript(script.id)}
                >
                  <div className="flex justify-between items-center mb-4">
                    <h3 className="text-xl font-bold text-white">{script.name}</h3>
                    <button
                      onClick={() => copyToClipboard(script.code)}
                      className="px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-black rounded-md font-medium transition-colors duration-200 flex items-center gap-2"
                    >
                      <span>نسخ السكربت</span>
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        strokeWidth="2"
                        strokeLinecap="round"
                        strokeLinejoin="round"
                      >
                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2" />
                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1" />
                      </svg>
                    </button>
                  </div>
                  <p className="text-white/80 mb-4 text-right">{script.description}</p>
                  <pre className="bg-black/30 p-4 rounded-md overflow-x-auto">
                    <code className="text-green-400">{script.code}</code>
                  </pre>
                </div>
              ))}
            </div>
          </Authenticated>
          {!selectedScript && (
            <div className="text-center text-white">
              <SignInForm />
            </div>
          )}
        </div>
      </main>
      <Toaster />
    </div>
  );
}
