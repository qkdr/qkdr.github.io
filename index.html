<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>موقع عرض أكواد سكربتات روبلوكس</title>
  <style>
    /* ======== إعدادات عامة ======== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    html {
      scroll-behavior: smooth;
    }
    body {
      font-family: "Arial", sans-serif;
      background: #121212;
      color: #e0e0e0;
      line-height: 1.6;
      direction: rtl;
      min-height: 100vh;
      overflow-x: hidden;
    }
    a {
      color: inherit;
      text-decoration: none;
    }
    ul {
      list-style: none;
    }
    button {
      font-family: inherit;
      cursor: pointer;
      border: none;
      background: none;
    }

    /* ======== زر القائمة (هامبرجر) ======== */
    .menu-btn {
      position: fixed;
      top: 15px;
      left: 15px;
      width: 35px;
      height: 28px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      z-index: 200;
    }
    .menu-btn span {
      display: block;
      height: 4px;
      background: #e0e0e0;
      border-radius: 2px;
      transition: transform 0.3s, opacity 0.3s;
    }

    /* ======== قائمة التنقل المنبثقة ======== */
    .menu-overlay {
      position: fixed;
      top: 0;
      left: -100%;
      width: 250px;
      height: 100%;
      background: #1f1f1f;
      box-shadow: 2px 0 12px rgba(0, 0, 0, 0.7);
      transition: left 0.4s ease;
      z-index: 150;
      padding-top: 60px;
    }
    .menu-overlay.show {
      left: 0;
    }
    .menu-overlay ul {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
    }
    .menu-overlay li {
      margin: 15px 20px;
    }
    .menu-overlay li button {
      background: #272727;
      color: #f1c40f;
      padding: 10px 18px;
      border-radius: 25px;
      width: 100%;
      text-align: right;
      font-size: 1rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
      transition: background 0.3s, transform 0.3s;
    }
    .menu-overlay li button:hover {
      background: #f1c40f;
      color: #1f1f1f;
      transform: translateX(-5px);
    }

    /* ======== قسم المقدمة (Intro Section) ======== */
    #section-intro {
      background: linear-gradient(135deg, #1b1b2f, #2b2b3f);
      padding: 80px 20px;
      text-align: center;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
    }
    #section-intro h1 {
      font-size: 3rem;
      margin-bottom: 20px;
      color: #f1c40f;
      text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.6);
    }
    #section-intro p {
      font-size: 1.2rem;
      max-width: 800px;
      margin-bottom: 30px;
      color: #dcdcdc;
      line-height: 1.8;
    }
    #section-intro button {
      padding: 15px 30px;
      font-size: 1.1rem;
      border-radius: 50px;
      background: linear-gradient(45deg, #16a085, #1abc9c);
      color: #fff;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s, box-shadow 0.3s;
      margin-bottom: 40px;
    }
    #section-intro button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
    }

    /* ======== معرض الصور (Gallery) ======== */
    .gallery {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 25px;
      margin-bottom: 60px;
      width: 100%;
      max-width: 1000px;
    }
    .gallery-item {
      background: #272737;
      border: 3px solid #f39c12;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      overflow: hidden;
      width: 200px;
      text-align: center;
      transition: transform 0.3s;
    }
    .gallery-item:hover {
      transform: translateY(-8px);
    }
    .item-frame {
      padding: 12px;
      background: #3a3a5c;
      border-bottom: 2px solid #e67e22;
    }
    .item-frame img {
      width: 100%;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.5);
    }
    .item-name {
      background: #1f1f2f;
      padding: 10px;
      font-size: 1rem;
      color: #f1c40f;
      text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.5);
      border-top: 2px solid #e67e22;
    }

    /* ======== قسم بحث الأكواد (Code Search Section) ======== */
    #section-search {
      display: none;
      padding: 60px 20px;
      background: #1f1f2f;
      min-height: 100vh;
    }
    /* إحصائيات المابات */
    .script-stats {
      max-width: 700px;
      margin: 0 auto 40px auto;
      background: #272737;
      border-left: 5px solid #f1c40f;
      border-radius: 8px;
      padding: 20px 25px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
      color: #e0e0e0;
      font-size: 1rem;
      line-height: 1.5;
    }
    .script-stats ul {
      margin-top: 12px;
      padding-right: 20px;
    }
    .script-stats li {
      margin-bottom: 8px;
    }

    /* الإطار الخارجي المتداخل */
    .outer-box {
      width: 100%;
      max-width: 700px;
      background: #272737;
      border: 2px solid #f39c12;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
      margin: 0 auto 40px auto;
    }
    .frame-box {
      background: #3a3a5c;
      border: 2px dashed #e67e22;
      border-radius: 10px;
      padding: 20px;
      box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.3);
    }
    .inner-box {
      background: #4b4b7c;
      border: 2px solid #f1c40f;
      border-radius: 8px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .inner-box input[type="text"] {
      width: 90%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      margin-bottom: 18px;
      font-size: 1rem;
      background: #1f1f2f;
      color: #e0e0e0;
      box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);
    }
    .inner-box input[type="text"]::placeholder {
      color: #bbb;
    }
    .inner-box button {
      padding: 12px 28px;
      border-radius: 50px;
      background: linear-gradient(45deg, #f39c12, #d35400);
      color: #fff;
      font-size: 1rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .inner-box button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
    }

    /* عرض أكواد المستخدم */
    #codes-container {
      width: 100%;
      max-width: 750px;
      margin: 0 auto 60px auto;
    }
    .code-card {
      background: #2f2f4f;
      border-left: 5px solid #f1c40f;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }
    .code-card h3 {
      margin: 0 0 12px 0;
      font-size: 1.3rem;
      color: #e67e22;
      text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.5);
    }
    .code-block {
      background: #3b3b5b;
      border: 1px solid #444;
      border-radius: 6px;
      padding: 15px;
      overflow-x: auto;
      color: #ecf0f1;
      font-family: "Courier New", monospace;
      font-size: 0.95rem;
      line-height: 1.5;
      box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.4);
    }

    /* الإشعارات */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #27ae60;
      color: #fff;
      padding: 18px 25px;
      border-radius: 8px;
      box-shadow: 0 0 16px rgba(0, 0, 0, 0.5);
      opacity: 0;
      transform: translateY(-30px);
      transition: opacity 0.4s ease, transform 0.4s ease;
      z-index: 250;
      font-size: 1rem;
      max-width: 300px;
      text-align: center;
    }
    .notification.show {
      opacity: 1;
      transform: translateY(0);
    }
    .notification.error {
      background: #c0392b;
    }

    /* ======== صفحة التواصل (Contact Section) ======== */
    #section-contact {
      display: none;
      padding: 60px 20px;
      background: #1d1d3f;
      min-height: 100vh;
      text-align: center;
    }
    #section-contact h2 {
      font-size: 2.2rem;
      margin-bottom: 20px;
      color: #f1c40f;
      text-shadow: 1px 1px 6px rgba(0, 0, 0, 0.5);
    }
    .contact-container {
      max-width: 700px;
      margin: 0 auto;
      background: #272737;
      border-left: 5px solid #f39c12;
      border-radius: 8px;
      padding: 25px 30px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
      text-align: center;
      color: #e0e0e0;
    }
    .contact-container p {
      margin-bottom: 15px;
      font-size: 1rem;
      line-height: 1.6;
    }
    .contact-container a.email-link {
      display: inline-block;
      background: linear-gradient(45deg, #e67e22, #f39c12);
      color: #fff;
      padding: 12px 24px;
      border-radius: 50px;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.3);
      transition: transform 0.3s, box-shadow 0.3s;
      font-size: 1rem;
      margin-top: 10px;
    }
    .contact-container a.email-link:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 18px rgba(0, 0, 0, 0.5);
    }
    .contact-container ul.info-list {
      margin-top: 20px;
      text-align: right;
    }
    .contact-container li {
      margin-bottom: 8px;
      color: #dcdcdc;
      font-size: 0.95rem;
    }

    /* ======== صفحة إدارة المابات المحمية بكلمة السر ======== */
    #section-map-admin {
      display: none;
      padding: 60px 20px;
      background: #1d1d3f;
      min-height: 100vh;
      text-align: center;
    }
    #section-map-admin h2 {
      font-size: 2.2rem;
      margin-bottom: 20px;
      color: #f1c40f;
      text-shadow: 1px 1px 6px rgba(0, 0, 0, 0.5);
    }
    .password-frame {
      max-width: 400px;
      margin: 0 auto 40px auto;
      background: #272737;
      border: 2px solid #f39c12;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
    }
    .password-frame input[type="password"] {
      width: 100%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      margin-bottom: 18px;
      font-size: 1rem;
      background: #1f1f2f;
      color: #e0e0e0;
      box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);
    }
    .password-frame button {
      padding: 12px 28px;
      border-radius: 50px;
      background: linear-gradient(45deg, #c0392b, #e74c3c);
      color: #fff;
      font-size: 1rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .password-frame button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
    }
    .map-admin-content {
      display: none;
      max-width: 800px;
      margin: 0 auto;
      text-align: right;
    }
    .map-admin-content h3 {
      color: #e67e22;
      font-size: 1.5rem;
      margin-bottom: 15px;
      text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.5);
    }
    .map-admin-content .map-list {
      background: #272737;
      border-left: 5px solid #f1c40f;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 30px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.5);
      color: #e0e0e0;
      font-size: 1rem;
    }
    .map-admin-content .map-list ul {
      padding-right: 20px;
    }
    .map-admin-content .map-list li {
      margin-bottom: 8px;
    }
    .map-admin-content .add-frame {
      background: #3a3a5c;
      border: 2px solid #e67e22;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 40px;
      box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.3);
    }
    .map-admin-content .add-frame input,
    .map-admin-content .add-frame textarea {
      width: 100%;
      margin-bottom: 15px;
      padding: 10px;
      border: none;
      border-radius: 6px;
      background: #1f1f2f;
      color: #e0e0e0;
      font-size: 1rem;
      box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);
    }
    .map-admin-content .add-frame textarea {
      resize: vertical;
      min-height: 100px;
    }
    .map-admin-content .add-frame button {
      padding: 12px 28px;
      border-radius: 50px;
      background: linear-gradient(45deg, #27ae60, #2ecc71);
      color: #fff;
      font-size: 1rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .map-admin-content .add-frame button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
    }
    .map-admin-content .search-frame {
      background: #4b4b7c;
      border: 2px solid #f1c40f;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: inset 0 0 12px rgba(0, 0, 0, 0.3);
      text-align: center;
    }
    .map-admin-content .search-frame input[type="text"] {
      width: 90%;
      padding: 12px;
      border: none;
      border-radius: 8px;
      margin-bottom: 18px;
      font-size: 1rem;
      background: #1f1f2f;
      color: #e0e0e0;
      box-shadow: inset 0 0 8px rgba(0, 0, 0, 0.5);
    }
    .map-admin-content .search-frame button {
      padding: 12px 28px;
      border-radius: 50px;
      background: linear-gradient(45deg, #f39c12, #d35400);
      color: #fff;
      font-size: 1rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .map-admin-content .search-frame button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
    }
    .map-admin-content .codes-list {
      margin-top: 20px;
    }
    .map-admin-content .code-item {
      background: #2f2f4f;
      border-left: 5px solid #e67e22;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
    }
    .map-admin-content .code-item .code-name {
      font-size: 1.1rem;
      color: #f1c40f;
      margin-bottom: 10px;
    }
    .map-admin-content .code-item button {
      padding: 8px 18px;
      border-radius: 50px;
      background: linear-gradient(45deg, #2980b9, #3498db);
      color: #fff;
      font-size: 0.95rem;
      margin: 5px 10px 10px 0;
      box-shadow: 0 3px 12px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    .map-admin-content .code-item button:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 18px rgba(0, 0, 0, 0.5);
    }
    .map-admin-content .code-item pre {
      background: #3b3b5b;
      border: 1px solid #444;
      border-radius: 6px;
      padding: 10px;
      overflow-x: auto;
      color: #ecf0f1;
      font-family: "Courier New", monospace;
      font-size: 0.95rem;
      line-height: 1.5;
      display: none;
      margin-top: 10px;
    }
    .map-admin-content .export-btn {
      margin-top: 15px;
      display: inline-block;
      padding: 12px 24px;
      background: linear-gradient(45deg, #f1c40f, #e67e22);
      color: #121212;
      border-radius: 50px;
      font-size: 1rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
      transition: transform 0.3s, box-shadow 0.3s;
      text-decoration: none;
    }
    .map-admin-content .export-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6);
    }
  </style>
</head>
<body>

  <!-- ======== زر القائمة (Hamburger) ======== -->
  <div class="menu-btn" onclick="toggleMenu()">
    <span></span>
    <span></span>
    <span></span>
  </div>

  <!-- ======== القائمة المنبثقة ======== -->
  <nav class="menu-overlay" id="menu-overlay">
    <ul>
      <li><button onclick="showSection('section-intro'); toggleMenu();">الرئيسية</button></li>
      <li><button onclick="showSection('section-search'); toggleMenu();">بحث الأكواد</button></li>
      <li><button onclick="showSection('section-contact'); toggleMenu();">تواصل معنا</button></li>
      <li><button onclick="showSection('section-map-admin'); toggleMenu();">إدارة المابات</button></li>
    </ul>
  </nav>

  <!-- ======== قسم المقدمة ======== -->
  <section id="section-intro">
    <h1>مرحباً بك في موقع أكواد سكربتات روبلوكس</h1>
    <p>
      في هذا الموقع، يمكنك عرض أكواد سكربتات Roblox بأناقة وفخامة.  
      لدينا واجهة جذابة تشمل مقدمة مميزة، إمكانية البحث عن السكربتات وعرض أكوادها في واجهة شيفرة أنيقة، بالإضافة إلى صفحة تواصل مخصصة للاستفسارات أو الملاحظات.  
      كما يمكن للمسؤولين إضافة أكواد جديدة وربطها بأسماء خرائط وحفظها تلقائياً.
    </p>
    <button onclick="showSection('section-search')">اذهب إلى البحث عن الأكواد</button>

    <!-- ===== معرض الصور ===== -->
    <div class="gallery">
      <div class="gallery-item">
        <div class="item-frame">
          <img src="https://via.placeholder.com/200x150.png?text=صورة+1" alt="صورة 1" />
        </div>
        <div class="item-name">اسم السكربت 1</div>
      </div>
      <div class="gallery-item">
        <div class="item-frame">
          <img src="https://via.placeholder.com/200x150.png?text=صورة+2" alt="صورة 2" />
        </div>
        <div class="item-name">اسم السكربت 2</div>
      </div>
      <div class="gallery-item">
        <div class="item-frame">
          <img src="https://via.placeholder.com/200x150.png?text=صورة+3" alt="صورة 3" />
        </div>
        <div class="item-name">اسم السكربت 3</div>
      </div>
      <div class="gallery-item">
        <div class="item-frame">
          <img src="https://via.placeholder.com/200x150.png?text=صورة+4" alt="صورة 4" />
        </div>
        <div class="item-name">اسم السكربت 4</div>
      </div>
    </div>
  </section>

  <!-- ======== قسم بحث الأكواد ======== -->
  <section id="section-search">
    <!-- إحصائيات المابات المتوفرة -->
    <div class="script-stats">
      <div>
        <strong>عدد المابات المتوفرة حالياً:</strong> <span id="map-count">0</span>
      </div>
      <div>
        <strong>أسماء المابات:</strong>
        <ul id="map-list-display"></ul>
      </div>
    </div>

    <!-- الإطار الخارجي المتداخل لبحث الأكواد -->
    <div class="outer-box">
      <div class="frame-box">
        <div class="inner-box">
          <input type="text" id="search-map-name" placeholder="اكتب اسم الخريطة للبحث..." />
          <button onclick="showMapCodes()">عرض أكواد الخريطة</button>
        </div>
      </div>
    </div>

    <!-- حاوية عرض أكواد الخريطة -->
    <div id="codes-container"></div>
  </section>

  <!-- ======== الإشعار ======== -->
  <div id="notification" class="notification"></div>

  <!-- ======== صفحة التواصل ======== -->
  <section id="section-contact">
    <h2>تواصل معنا</h2>
    <div class="contact-container">
      <p>إذا كان لديك أي استفسار أو اقتراح أو كنت تريد إضافة سكربت جديد إلى قاعدة البيانات، لا تتردد في مراسلتنا. نحن هنا للمساعدة!</p>
      <a href="mailto:example@example.com" class="email-link">example@example.com</a>
      <ul class="info-list">
        <li><strong>معرف Discord:</strong> RobloxHelper#1234</li>
        <li><strong>للاطلاع على مشاريعنا:</strong> تابعنا على <a href="https://github.com/" target="_blank">GitHub</a></li>
        <li><strong>جميع الحقوق محفوظة © 2025</strong></li>
      </ul>
    </div>
  </section>

  <!-- ======== صفحة إدارة المابات المحمية بكلمة السر ======== -->
  <section id="section-map-admin">
    <h2>إدارة أكواد المابات (محمي بكلمة سر)</h2>
    <div class="password-frame" id="password-frame">
      <input type="password" id="admin-password-input" placeholder="أدخل كلمة السر" />
      <button onclick="checkPassword()">دخول</button>
    </div>

    <div class="map-admin-content" id="map-admin-content">
      <!-- زر تنزيل البيانات -->
      <a href="#" id="export-btn" class="export-btn" onclick="exportMapData()">تنزيل بيانات المابات</a>

      <!-- قائمة المابات الحالية -->
      <div class="map-list">
        <h3>قائمة المابات المتوفرة:</h3>
        <ul id="map-list-ul"></ul>
      </div>

      <!-- إضافة كود جديد -->
      <div class="add-frame">
        <h3>إضافة كود جديد إلى خريطة</h3>
        <input type="text" id="new-map-name" placeholder="اسم الخريطة" />
        <input type="text" id="new-code-name" placeholder="اسم الكود" />
        <textarea id="new-code-content" placeholder="شيفرة الكود هنا..."></textarea>
        <button onclick="addMapCode()">إضافة الكود</button>
      </div>

      <!-- البحث في أكواد خريطة معينة وعرض أزرار (عرض ومسح) -->
      <div class="search-frame">
        <h3>البحث في أكواد خريطة</h3>
        <input type="text" id="search-map-name-admin" placeholder="اكتب اسم الخريطة للبحث" />
        <button onclick="showMapCodesAdmin()">عرض أكواد الخريطة</button>
      </div>

      <!-- عرض نتائج البحث (أكواد خريطة) مع أزرار عرض ومسح -->
      <div class="codes-list" id="map-codes-list"></div>
    </div>
  </section>

  <script>
    /* ======= تعريف مفتاح التخزين المحلي للمابات ======= */
    const MAP_CODES_KEY = "mapCodesData";
    const ADMIN_PASSWORD = "admin123"; // كلمة السر المطلوبة

    /* ======= التعامل مع التنقل بين الأقسام ======= */
    function showSection(sectionId) {
      const sections = ["section-intro", "section-search", "section-contact", "section-map-admin"];
      sections.forEach(id => {
        document.getElementById(id).style.display = (id === sectionId) ? "block" : "none";
      });
      if (sectionId === "section-search") {
        updateMapDisplay();
      }
      if (sectionId === "section-map-admin") {
        document.getElementById("admin-password-input").value = "";
        document.getElementById("map-codes-list").innerHTML = "";
      }
    }

    // عند تحميل الصفحة: عرض المقدمة
    window.onload = () => {
      showSection("section-intro");
    };

    /* ======= دالة عرض رسالة إشعار ======= */
    function showNotification(message, isError = false) {
      const notif = document.getElementById("notification");
      notif.textContent = message;
      notif.classList.remove("error");
      if (isError) notif.classList.add("error");
      notif.classList.add("show");
      setTimeout(() => {
        notif.classList.remove("show");
      }, 3000);
    }

    /* ======= الحصول على بيانات المابات من localStorage أو إنشاءها إذا لم توجد ======= */
    function getMapCodesData() {
      const raw = localStorage.getItem(MAP_CODES_KEY);
      return raw ? JSON.parse(raw) : {};
    }

    /* ======= حفظ بيانات المابات في localStorage ======= */
    function saveMapCodesData(data) {
      localStorage.setItem(MAP_CODES_KEY, JSON.stringify(data));
    }

    /* ======= تحديث عرض قائمة المابات في صفحة البحث ======= */
    function updateMapDisplay() {
      const data = getMapCodesData();
      const names = Object.keys(data);
      const countElem = document.getElementById("map-count");
      const listElem = document.getElementById("map-list-display");
      countElem.textContent = names.length;
      listElem.innerHTML = "";
      if (names.length === 0) {
        const li = document.createElement("li");
        li.textContent = "لا توجد مابات حالياً.";
        listElem.appendChild(li);
      } else {
        names.forEach((name, index) => {
          const li = document.createElement("li");
          li.textContent = `${index + 1}. ${name} (عدد الأكواد: ${data[name].length})`;
          listElem.appendChild(li);
        });
      }
      document.getElementById("search-map-name").value = "";
      document.getElementById("codes-container").innerHTML = "";
    }

    /* ======= دالة عرض أكواد خريطة معينة للمستخدم ======= */
    function showMapCodes() {
      const mapName = document.getElementById("search-map-name").value.trim();
      const container = document.getElementById("codes-container");
      container.innerHTML = "";
      if (!mapName) {
        showNotification("الرجاء إدخال اسم الخريطة للبحث!", true);
        return;
      }
      const data = getMapCodesData();
      if (!data[mapName] || data[mapName].length === 0) {
        container.innerHTML = `<p style="color:#e0e0e0; font-size:1rem;">لا توجد أكواد للخريطة "${mapName}".</p>`;
        showNotification(`لا توجد أكواد للخريطة "${mapName}"!`, true);
      } else {
        data[mapName].forEach((item, idx) => {
          const card = document.createElement("div");
          card.classList.add("code-card");

          const title = document.createElement("h3");
          title.textContent = `${idx + 1}. ${item.name}`;
          card.appendChild(title);

          const codeBlock = document.createElement("pre");
          codeBlock.classList.add("code-block");
          codeBlock.textContent = item.code;
          card.appendChild(codeBlock);

          container.appendChild(card);
        });
        showNotification(`تم عرض أكواد الخريطة "${mapName}" بنجاح!`, false);
      }
      document.getElementById("search-map-name").value = "";
    }

    /* ======= التحقق من كلمة السر وعرض محتوى الإدارة ======= */
    function checkPassword() {
      const pwdInput = document.getElementById("admin-password-input").value;
      if (pwdInput === ADMIN_PASSWORD) {
        document.getElementById("password-frame").style.display = "none";
        document.getElementById("map-admin-content").style.display = "block";
        updateMapListAdmin();
      } else {
        showNotification("كلمة السر خاطئة!", true);
      }
      document.getElementById("admin-password-input").value = "";
    }

    /* ======= تحديث قائمة المابات المعروضة في الإدارة ======= */
    function updateMapListAdmin() {
      const data = getMapCodesData();
      const ul = document.getElementById("map-list-ul");
      ul.innerHTML = "";
      const names = Object.keys(data);
      if (names.length === 0) {
        const li = document.createElement("li");
        li.textContent = "لا توجد مابات حالياً.";
        ul.appendChild(li);
      } else {
        names.forEach((name, index) => {
          const li = document.createElement("li");
          li.textContent = `${index + 1}. ${name} (عدد الأكواد: ${data[name].length})`;
          ul.appendChild(li);
        });
      }
    }

    /* ======= إضافة كود جديد لخريطة ======= */
    function addMapCode() {
      const mapName = document.getElementById("new-map-name").value.trim();
      const codeName = document.getElementById("new-code-name").value.trim();
      const codeContent = document.getElementById("new-code-content").value.trim();
      if (!mapName || !codeName || !codeContent) {
        showNotification("الرجاء ملء جميع الحقول لإضافة الكود!", true);
        return;
      }
      const data = getMapCodesData();
      if (!data[mapName]) {
        data[mapName] = [];
      }
      data[mapName].push({ name: codeName, code: codeContent });
      saveMapCodesData(data);
      showNotification(`تم إضافة الكود إلى خريطة "${mapName}" بنجاح!`, false);
      document.getElementById("new-map-name").value = "";
      document.getElementById("new-code-name").value = "";
      document.getElementById("new-code-content").value = "";
      updateMapListAdmin();
    }

    /* ======= دالة عرض أكواد خريطة معينة في الإدارة مع أزرار عرض ومسح ======= */
    function showMapCodesAdmin() {
      const mapName = document.getElementById("search-map-name-admin").value.trim();
      const container = document.getElementById("map-codes-list");
      container.innerHTML = "";
      if (!mapName) {
        showNotification("الرجاء إدخال اسم الخريطة للبحث!", true);
        return;
      }
      const data = getMapCodesData();
      if (!data[mapName] || data[mapName].length === 0) {
        container.innerHTML = `<p style="color:#e0e0e0; font-size:1rem;">لا توجد أكواد للخريطة "${mapName}".</p>`;
        showNotification(`لا توجد أكواد للخريطة "${mapName}"!`, true);
      } else {
        data[mapName].forEach((item, idx) => {
          const codeDiv = document.createElement("div");
          codeDiv.classList.add("code-item");

          // اسم الكود
          const nameElem = document.createElement("div");
          nameElem.classList.add("code-name");
          nameElem.textContent = `${idx + 1}. ${item.name}`;
          codeDiv.appendChild(nameElem);

          // زر عرض الشيفرة
          const showBtn = document.createElement("button");
          showBtn.textContent = "عرض الشيفرة";
          const codeBlock = document.createElement("pre");
          codeBlock.textContent = item.code;
          codeBlock.style.display = "none";
          showBtn.onclick = () => {
            codeBlock.style.display = codeBlock.style.display === "block" ? "none" : "block";
          };
          codeDiv.appendChild(showBtn);

          // زر مسح الكود
          const delBtn = document.createElement("button");
          delBtn.textContent = "مسح الكود";
          delBtn.style.background = "linear-gradient(45deg, #c0392b, #e74c3c)";
          delBtn.onclick = () => {
            if (confirm(`هل أنت متأكد من مسح الكود "${item.name}" من الخريطة "${mapName}"؟`)) {
              data[mapName].splice(idx, 1);
              if (data[mapName].length === 0) {
                delete data[mapName];
              }
              saveMapCodesData(data);
              showNotification(`تم مسح الكود "${item.name}" من الخريطة "${mapName}"!`, false);
              updateMapListAdmin();
              showMapCodesAdmin(); // إعادة عرض القائمة بعد المسح
            }
          };
          codeDiv.appendChild(delBtn);

          codeDiv.appendChild(codeBlock);
          container.appendChild(codeDiv);
        });
        showNotification(`تم عرض أكواد الخريطة "${mapName}" بنجاح!`, false);
      }
      document.getElementById("search-map-name-admin").value = "";
    }

    /* ======= تصدير بيانات المابات كملف JSON ======= */
    function exportMapData() {
      const data = getMapCodesData();
      const jsonStr = JSON.stringify(data, null, 2);
      const blob = new Blob([jsonStr], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.getElementById("export-btn");
      a.href = url;
      a.download = "mapCodesData.json";
      showNotification("جاهز لتنزيل ملف بيانات المابات.", false);
    }

    /* ======= دالة فتح وإغلاق القائمة ======= */
    function toggleMenu() {
      const overlay = document.getElementById("menu-overlay");
      overlay.classList.toggle("show");
      const spans = document.querySelectorAll(".menu-btn span");
      if (overlay.classList.contains("show")) {
        spans[0].style.transform = "rotate(45deg) translate(5px, 5px)";
        spans[1].style.opacity = "0";
        spans[2].style.transform = "rotate(-45deg) translate(6px, -6px)";
      } else {
        spans[0].style.transform = "rotate(0) translate(0, 0)";
        spans[1].style.opacity = "1";
        spans[2].style.transform = "rotate(0) translate(0, 0)";
      }
    }
  </script>
</body>
</html>
